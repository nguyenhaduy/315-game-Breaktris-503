<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="client/css/style.css" />
    <title>Breaktris HTML5</title>
    <style>* { padding: 0; margin: 0; }</style>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script>
    	var myID;
        var playing = false;        
        // var isGameOver = false;
        var blockRotate = 0;
        var blockInvis = 0;
        var addBrickLine = 0;
        var bricksClear = 0;
        var lineClear = 0;
        var WinImg;
        var LoseImg;
        var PlayButton;
        var NewButton;
        var JoinButton;
        var IntroButton;
        var TetrisBoard;
        var BreakoutBoard;
        var MainScreen;
        var JoinRoomBox;
        var TetrisLose = false;
        var WinNumber = 0;

    	socket = io();

        // Update ID
    	socket.on('player ID',function(data){
            window.myID = data;
            console.log(myID);
        })

        function create() {}
    </script>
    
    <script src="client/engine/phaser.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="client/js/pieces.js"></script>
    <script type="text/javascript" src="client/js/BulkImageLoader.js"></script>
    
    

</head>
<body>
    <div id="game">
        <div id="MainScreen" >
            <canvas id="menu" width="640" height="640"></canvas>
            <img id="TitleBackground" src="client/img/title.jpg" align="top"></img>
            <button id="PlayButton" style="display:none;">Play Game</button>
            <img id="NewButton" src="client/img/NewButton.png"></img>
            <img id="JoinButton" src="client/img/JoinButton.png"></img>
            <img id="IntroButton" src="client/img/IntroButton.png"></img>
            
        </div>

        <div id="CreateRoomScreen" style="display:none;">
            <img id="CreateRoomImg" src="client/img/CreateRoomImg.jpg"></img>
            Room name: <input id="CreateRoomName" type="text"></input><br>
            <button id="CreateButton"><font size="4">Create New Room</font></button>
            <button id="BackButton1"><font size="4">Back</font></button>            
        </div>

        <div id="JoinRoomScreen" style="display:none;">
            <img id="JoinRoomImg" src="client/img/JoinRoomImg.jpg"></img>
            Room name: <input id="JoinRoomName" type="text"></input><br>
            <select name="drop1" id="JoinRoomBox" size="4" multiple="multiple">
                <option value="1">item 1</option>
                <option value="2">item 2</option>
                <option value="3">item 3</option>
                <option value="4">item 4</option>
                <option value="0">All</option>

            </select>

            <button id="JoinRoomButton"><font size="4">Join Room</font></button>
            <button id="BackButton2"><font size="4">Back</font></button>            
        </div>

        
        <div id="GameBoard" style="display:none;">

            <img id="GameBackground" src="client/img/GameBackground.jpg"></img>

            <button id="QuitButton">Rage Quit</button>

        	<div id="TetrisBoard">
                <canvas id="tetris" width="320" height="640"></canvas>
                <script type="text/javascript" src="client/js/tetris.js"></script>
            </div>            

            <div id="BreakoutBoard">
                <div id="breakout" width="320" height="640"></div>
                <script src="client/js/breakout.js" type="text/javascript"></script>
            </div>

            <div id="score">
                <p>Lines: <span id="lines"></span></p>
            </div>

        </div>
        

        <img id="WinImg" src="client/img/WinGame.jpg" align="top" style="display:none;"></img>
        <img id="LoseImg" src="client/img/LoseGame.jpg" align="top" style="display:none;"></img>
        <img id="DrawImg" src="client/img/DrawGame.jpg" align="top" style="display:none;"></img>
        <img id="Round2Img" src="client/img/Round2.jpg" align="top" style="display:none;"></img>

        <script type="text/javascript">
                WinImg = document.getElementById('WinImg');
                LoseImg = document.getElementById('LoseImg');
                DrawImg = document.getElementById('DrawImg');
                Round2Img = document.getElementById('Round2Img');

                MainScreen = document.getElementById('MainScreen');
                PlayButton = document.getElementById('PlayButton');
                NewButton = document.getElementById('NewButton');
                JoinButton = document.getElementById('JoinButton');
                IntroButton = document.getElementById('PlayButton');

                CreateRoomScreen = document.getElementById('CreateRoomScreen');
                CreateButton = document.getElementById('CreateButton');
                BackButton1 = document.getElementById('BackButton1');
                CreateRoomName = document.getElementById('CreateRoomName');

                JoinRoomScreen = document.getElementById('JoinRoomScreen');
                JoinRoomButton = document.getElementById('JoinRoomButton');
                BackButton2 = document.getElementById('BackButton2');
                JoinRoomName = document.getElementById('JoinRoomName');
                JoinRoomBox = document.getElementById("JoinRoomBox");

                TetrisBoard = document.getElementById('TetrisBoard');
                GameBoard = document.getElementById('GameBoard');
                BreakoutBoard = document.getElementById('BreakoutBoard');
                QuitButton = document.getElementById('QuitButton');                                

                PlayButton.onclick = function (){
                    MainScreen.style.display = 'none';
                    TetrisBoard.style.display = 'inline-block';
                    BreakoutBoard.style.display = 'inline-block';
                }

                NewButton.onclick = function (){
                    MainScreen.style.display = 'none';
                    CreateRoomScreen.style.display = 'inline-block';
                }

                JoinButton.onclick = function (){
                    MainScreen.style.display = 'none';
                    
                    // var option = document.createElement("option");
                    // option.text = "Kiwi";
                    // JoinRoomBox.add(option);
                    JoinRoomScreen.style.display = 'inline-block';
                }

                JoinRoomButton.onclick = function (){
                    socket.emit('JoinRoom', JoinRoomName.value);
                    socket.on('JoinRoom', function(data){
                        if (data == true){              
                            JoinRoomScreen.style.display = 'none';
                            GameBoard.style.display = 'inline-block';
                            // TetrisBoard.style.display = 'inline-block';
                            // BreakoutBoard.style.display = 'inline-block';
                            BreakoutRun();
                        }
                        else{
                            alert('This room is not available!');
                        }
                    })
                }

                CreateButton.onclick = function (){
                    socket.emit('CreateRoom', CreateRoomName.value);
                    socket.on('CreateRoom', function(data){
                        if (data == true){    
                            CreateRoomScreen.style.display = 'none';
                            GameBoard.style.display = 'inline-block';
                            // TetrisBoard.style.display = 'inline-block';
                            // BreakoutBoard.style.display = 'inline-block';
                            BreakoutRun();
                        }
                        else{
                            alert('This room name is already taken!');
                        }
                    })
                }

                BackButton1.onclick = function (){
                    MainScreen.style.display = 'inline-block';
                    CreateRoomScreen.style.display = 'none';
                }

                BackButton2.onclick = function (){
                    MainScreen.style.display = 'inline-block';
                    JoinRoomScreen.style.display = 'none';
                }

                QuitButton.onclick = function (){
                    location.reload();
                }
            </script>

    </div>
</body>
</html>